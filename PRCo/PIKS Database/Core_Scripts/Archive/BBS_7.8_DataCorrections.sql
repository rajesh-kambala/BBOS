DELETE FROM PRBBOSPrivilege WHERE IndustryType = 'L'
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsListingPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Role) VALUES ('L', 250, 'CompanyDetailsARReportsPage', 'ARReportAccess');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsBranchesAffiliationsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsClassificationsCommoditesProductSerivcesSpeciesPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsContactsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsCustomPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsNewsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyDetailsUpdatesPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Role) VALUES ('L', 250, 'CompanyEditListingPage', 'EditListing');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Role) VALUES ('L', 250, 'CompanyEditReferenceListPage', 'UpdateConnectionList');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyEditFinancialStatementPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByPhoneFaxNumber');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByEmail');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByHasEmail');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByHasFax');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByListingStatus');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByNewListings');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchRatingPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'CompanySearchByPayIndicator');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'CompanySearchByPayReportCount');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'CompanySearchByCreditWorthRating');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchLocationPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByRadius');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchSpeciePage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchBySpecie');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchProductsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByProducts');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchServicesPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByServices');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchClassificationsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByClassifications');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByNumberofRetailStores');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchProfilePage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByBrand');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByCorporateStructure');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByMiscListing');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByVolume');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchCustomPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByHasNotes');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchByWatchdogList');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'SaveSearches');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'BBOSTrainingPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'MembershipGuidePage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'ViewRating');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanySearchResultsAutoRedirect1Result');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyUpdatesDownloadPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyUpdatesSearchPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CustomFields');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportCompanyDataExport');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportDetailedCompanyDataExport');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportContactExportAllContacts');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportContactExportHeadExecutive');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonvCard');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'DownloadsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Role) VALUES ('L', 250, 'BusinessReportPurchase', 'UseServiceUnits');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'BusinessReportSurvey');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ManageMembershipPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'NewsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'Notes');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonDetailsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchByRole');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchLocationPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchByRadius');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchCustomPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchByNotes');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonSearchByWatchdogList');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PurchasesPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'RecentViewsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'CompanyReportsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonReportsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportCompanyListing');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'ReportFullBlueBookListing');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportMailingLabels');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportNotes');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportQuickList');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportPersonnel');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportCompanyUpdateList');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportCreditSheet');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'ReportCreditSheetExport');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Role) VALUES ('L', 250, 'TradeExperienceSurveyPage', 'SubmitTES');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'UserContacts');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'PersonAccessListPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'WatchdogListAdd');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 250, 'WatchdogListsPage');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 999999, 'SystemAdmin');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'CompanySearchByBBScore');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'DataExportCompanyDataExportWBBScore');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'ViewBBScore');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'ViewPayIndicator');
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege) VALUES ('L', 400, 'ReportBBScore');



UPDATE PRBBOSPrivilege SET Visible = 1, Enabled = 0 WHERE  IndustryType = 'L'; 
UPDATE PRBBOSPrivilege SET Visible = 0 WHERE Privilege = 'ViewBBScore' AND  IndustryType = 'L';
Go

DELETE FROM NewProduct WHERE prod_ProductID = 85
INSERT INTO NewProduct
	   (Prod_ProductID,prod_Active,prod_UOMCategory,prod_name,prod_code,prod_productfamilyid,prod_IndustryTypeCode,prod_PRRecurring,prod_PRSequence,prod_PRDescription,
	    prod_PRWebAccess, prod_PRWebUsers, prod_PRWebAccessLevel,  prod_PRServiceUnits, 
	    Prod_CreatedBy,Prod_CreatedDate,Prod_UpdatedBy,Prod_UpdatedDate,Prod_TimeStamp)
VALUES (85, 'Y', 6000, 'Lumber Blue Book Service: 100', 'L100', 5, ',L,', 'Y', 5, '<ul class="Bullets"><li>1 BBOS user license</li><li>3 Business Reports</li></ul>',
        'Y', 1, '250', 3,
		-1,GETDATE(),-1,GETDATE(),GETDATE());
Go

--UPDATE NewProduct SET prod_PRServiceUnits=40, prod_PRDescription='<ul class="Bullets"><li>4 BBOS user licenses</li><li>40 Business Reports</li></ul>' WHERE prod_ProductID=62

DELETE FROM NewProduct WHERE prod_ProductID = 86
INSERT INTO NewProduct
	   (Prod_ProductID,prod_Active,prod_UOMCategory,prod_name,prod_code,prod_productfamilyid,prod_IndustryTypeCode,prod_PRRecurring,prod_PRSequence,prod_PRDescription,
	    prod_PRWebAccess, prod_PRWebUsers, prod_PRWebAccessLevel,  prod_PRServiceUnits, 
	    Prod_CreatedBy,Prod_CreatedDate,Prod_UpdatedBy,Prod_UpdatedDate,Prod_TimeStamp)
VALUES (86, 'Y', 6000, 'Lumber Blue Book Service: 400', 'L400', 5, ',L,', 'Y', 30, '<ul class="Bullets"><li>20 BBOS user licenses</li><li>225 Business Reports</li></ul>',
        'Y', 20, '400', 225,
		-1,GETDATE(),-1,GETDATE(),GETDATE());
Go

DELETE FROM NewProduct WHERE prod_ProductID = 87
INSERT INTO NewProduct
	   (Prod_ProductID,prod_Active,prod_UOMCategory,prod_name,prod_code,prod_productfamilyid,prod_IndustryTypeCode,prod_PRRecurring,prod_PRSequence,prod_PRDescription,
	    prod_PRWebAccess, prod_PRWebUsers, prod_PRWebAccessLevel,  prod_PRServiceUnits, 
	    Prod_CreatedBy,Prod_CreatedDate,Prod_UpdatedBy,Prod_UpdatedDate,Prod_TimeStamp)
VALUES (87, 'Y', 6000, 'Basic Lumber BBOS License', 'LBSCLIC', 6, ',L,', 'Y', 30, 'Provides limited access to online features and allows you to search companies by name, city and state. Access Business Reports, reference intormation, create account lists to print, and read news items on private and public companies.',
        'Y', 1, '250', 0,
		-1,GETDATE(),-1,GETDATE(),GETDATE());


UPDATE [MAS_PRC].[dbo].[IM_SalesKitDetail] SET ComponentItemCode = 'LBSCLIC' WHERE SalesKitNo = 'L100' AND ComponentItemCode = 'LMBLIC'
UPDATE MAS_PRC.dbo.CI_Item SET ItemCode = 'KYCG' WHERE ItemCode = 'KYC Copy'
Go

--SELECT * FROM NewProduct WHERE prod_productfamilyid=5 AND prod_IndustryTypeCode=',L,' ORDER BY prod_PRSequence

UPDATE PRBBScore
   SET prbs_PRPublish = 'Y',
       prbs_RunDate = prbs_Date
  FROM Company
 WHERE comp_CompanyID = prbs_CompanyID
   AND comp_PRIndustryType = 'L'
Go

EXEC usp_UpdateBBScoreStatistics '2015-12-31'
EXEC usp_UpdateBBScoreStatistics '2016-01-31'
EXEC usp_UpdateBBScoreStatistics '2016-02-29'
EXEC usp_UpdateBBScoreStatistics '2016-03-31'
EXEC usp_UpdateBBScoreStatistics '2016-04-30'
EXEC usp_UpdateBBScoreStatistics '2016-05-31'
EXEC usp_UpdateBBScoreStatistics '2016-06-30'
EXEC usp_UpdateBBScoreStatistics '2016-07-31'
EXEC usp_UpdateBBScoreStatistics '2016-08-31'
EXEC usp_UpdateBBScoreStatistics '2016-09-30'
EXEC usp_UpdateBBScoreStatistics '2016-10-31'
EXEC usp_UpdateBBScoreStatistics '2016-11-30'

UPDATE PRBBScore
   SET prbs_Current = NULL
  FROM Company
 WHERE prbs_CompanyID = comp_CompanyID
   AND comp_PRIndustryType = 'L'
   AND prbs_Current = 'Y'
   AND prbs_Date <> '2016-11-30 00:00:00.000'

UPDATE PRBBScore
   SET prbs_Current = 'Y'
  FROM Company
 WHERE prbs_CompanyID = comp_CompanyID
   AND comp_PRIndustryType = 'L'
   AND prbs_Current IS NULL
   AND prbs_Date = '2016-11-30 00:00:00.000'

Go


--SELECT DISTINCT prbs_Date FROM PRBBScore INNER JOIN Company ON comp_CompanyID = prbs_CompanyID  AND comp_PRIndustryType = 'L'

Go

DELETE FROM PRBBOSPrivilege WHERE Privilege = 'PersonSearchByIndustry'AND IndustryType IN ('P', 'T', 'S')
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('P', 400, 'PersonSearchByIndustry', 1, 0);
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('S', 400, 'PersonSearchByIndustry', 1, 0);
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('T', 400, 'PersonSearchByIndustry', 1, 0);
UPDATE PRBBOSPrivilege SET AccessLevel=400 WHERE Privilege = 'PersonSearchByRole'AND IndustryType IN ('P', 'T', 'S')
Go

DELETE FROM PRAttentionLine WHERE prattn_ItemCode = 'KYCG'
INSERT INTO PRAttentionLine (prattn_CompanyID, prattn_ItemCode, prattn_PersonID, prattn_CustomLine, prattn_AddressID, prattn_Disabled, prattn_CreatedBy, prattn_CreatedDate)
SELECT comp_CompanyID, 'KYCG', prattn_PersonID, prattn_CustomLine, prattn_AddressID, CASE WHEN prattn_AddressID = 0 THEN 'Y' WHEN prattn_AddressID IS NULL THEN 'Y' ELSE NULL END, 1, GETDATE()
  FROM (
SELECT DISTINCT comp_CompanyID, prattn_PersonID, prattn_CustomLine, prattn_AddressID,
       RANK() OVER (PARTITION BY comp_CompanyID ORDER BY prattn_CreatedDate) as Rnk
  FROM Company
       INNER JOIN PRAttentionLine ON comp_CompanyID = prattn_CompanyID
	   INNER JOIN PRService ON comp_CompanyID = prse_CompanyID AND prse_Primary = 'Y'
 WHERE comp_PRIndustryType NOT IN ('L')
   AND prattn_ItemCode = 'BPRINT') T1
WHERE Rnk = 1
ORDER BY comp_CompanyID
Go




DELETE FROM PRBBOSPrivilege WHERE Privilege = 'ViewCompanyListing' 
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('P', 200, 'ViewCompanyListing', 0, 0);
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('S', 200, 'ViewCompanyListing', 0, 0);
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('T', 200, 'ViewCompanyListing', 0, 0);
INSERT INTO PRBBOSPrivilege (IndustryType, AccessLevel, Privilege, Visible, Enabled) VALUES ('L', 400, 'ViewCompanyListing', 0, 0);
Go


DELETE FROM PRWebUserLocalSource WHERE prwuls_WebUserID IN (SELECT prwu_WebUserID FROM PRWebUser WHERE prwu_Disabled = 'Y')
Go


INSERT INTO PRRegion (prd2_RegionID, prd2_ParentId, prd2_Level, prd2_Name, prd2_Description, prd2_Type, prd2_CreatedBy, prd2_CreatedDate, prd2_UpdatedDate, prd2_TimeStamp)
VALUES (85, 1, 2, 'Throughout the United States', 'Throughout the United States', 'D', -1, GETDATE(), GETDATE(), GETDATE());

UPDATE PRRegion
   SET prd2_ParentId = 85,
       prd2_Level = 3
 WHERE prd2_RegionID IN (2,3,4,5,6,7)

UPDATE PRRegion
   SET prd2_Level = 4
 WHERE prd2_ParentId IN (2,3,4,5,6,7)
Go


ALTER TABLE PRAttentionLine DISABLE TRIGGER ALL
UPDATE PRAttentionLine
   SET prattn_IncludeWireTransferInstructions = 'Y'
  FROM vPRAddress 
 WHERE prattn_ItemCode = 'BILL'
   AND prattn_AddressID = addr_AddressID
   AND prcn_CountryID NOT IN (1,2)
   AND prattn_IncludeWireTransferInstructions IS NULL
ALTER TABLE PRAttentionLine ENABLE TRIGGER ALL
Go