<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="Tablix1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TradingAge">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TradingAge.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TradingAge</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Country">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Country.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Country</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="StateAbbr">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!StateAbbr.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>StateAbbr</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="City">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!City.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>City</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TradeStyle">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TradeStyle.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TradeStyle</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="State">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!State.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>State</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="CompanyID">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!CompanyID.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>CompanyID</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Logo">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Logo.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Logo</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TradeStyle1">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TradeStyle1.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TradeStyle1</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TradeStyle2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TradeStyle2.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TradeStyle2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TradeStyle3">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TradeStyle3.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TradeStyle3</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="CityState">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!CityState.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>CityState</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Phone">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Phone.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Phone</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Fax">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Fax.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Fax</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Email">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Email.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Email</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Web">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Web.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Web</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Phrase">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Phrase.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Phrase</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TMYear">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TMYear.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TMYear</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Classifications">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Classifications.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Classifications</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=IIF(IsNothing(Fields!DividerAge.Value), "", "Gainsboro")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="Details" />
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>dsResults</DataSetName>
        <Height>0.25in</Height>
        <Width>19in</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>0.25in</Height>
    <Style />
  </Body>
  <Width>19in</Width>
  <Page>
    <LeftMargin>1in</LeftMargin>
    <RightMargin>1in</RightMargin>
    <TopMargin>1in</TopMargin>
    <BottomMargin>1in</BottomMargin>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="BBS">
      <DataSourceReference>BBS</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>e5a983a5-5fce-4f50-8cdd-f3a721537920</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="dsResults">
      <Query>
        <DataSourceName>BBS</DataSourceName>
        <CommandText>Declare @BPCount int
Declare @BPDirectory Table
	(ndx int identity,
		ModifiedIndex int,
		Country nvarchar(30), 
		StateAbbr nvarchar(10), 
		City nvarchar(34), 
		TradeStyle nvarchar(104), 
		State nvarchar(34),
		CompanyID int, 
		Logo int, 
		TradeStyle1 nvarchar(104),	
		TradeStyle2 nvarchar(104), 
		TradeStyle3 nvarchar(104),
		CityState nvarchar(78), 
		Phone nvarchar(34), 
		Fax nvarchar(34), 
		Email nvarchar(50), 
		Web nvarchar(50), 
		Phrase nvarchar(50),
		TMYear int, 
		Classifications nvarchar(100), 
		Commodities nvarchar(100),
		TradingAge int,
		DividerAge int)

Declare @TradingAge Table
	(ndx int identity,
		age int)

Insert into @BPDirectory
Select
	0,
	prcn_Country,
	prst_Abbreviation,
	prci_City,
	comp_PRBookTradestyle,
	prst_State,
	Comp_CompanyID,
	left(comp_PRLogo, 6) as Logo,
	Trade1 = Null,
	Trade2 = Null,
	Trade3 = Null,
	CityStateCountryShort,
	MainPhone,
	Obsolete = Null,
	Email = RTRIM(EmailAddr),
	Website = RTRIM(WebAddr),
	TMSince = Case 
		when comp_PRIndustryType = 'P'
			then 'Trading Member Since' 
		when comp_PRIndustryType = 'T'
			then 'Transportation Member Since' 
		else null end,
	TMYear = Case Comp_PRTMFMAward when 'Y' then year(Comp_PRTMFMAwardDate) else null end,
	Classifications = Null,
	Commodities = Null,
	TradingAge = (YEAR(GETDATE()) - ISNULL((Case Comp_PRTMFMAward when 'Y' then year(Comp_PRTMFMAwardDate) else null end),YEAR(GETDATE()))) ,
	DividerAge = NULL
from
	Company with (NoLock)
	Inner Join vPRLocation on comp_PRListingCityID = prci_CityID
	left Outer Join 
		(Select plink_RecordID, 
		        PhoneRank = Rank() Over (Partition by plink_RecordID order by Phon_Default, phon_PhoneID desc), 
				MainPhone = dbo.ufn_FormatPhone(phon_CountryCode, phon_AreaCode, phon_Number, phon_PRExtension)
		   from vPRCompanyPhone with (nolock) 
		  where phon_PRPublish = 'Y' 
		    and plink_Type in ('P', 'PF', 'TP', 'TF', 'S')) PhoneTable on comp_CompanyID = plink_RecordID and phoneRank = 1
	Left Outer Join  
		(Select eCompID = elink_RecordID, 
		        EmailRank = Rank() Over (Partition by elink_RecordID order by emai_PRPreferredPublished, emai_EmailID desc), 
				EmailAddr = Emai_EmailAddress 
		   from vCompanyEmail with (nolock) 
		  where emai_PRPublish = 'Y' 
		   and elink_Type = 'E') EmailTable on ECompID = Comp_CompanyId and EmailRank = 1
	Left Outer Join
	   (Select wCompID = elink_RecordID, 
	           WebRank = Rank() Over (Partition by elink_RecordID order by emai_PRPreferredPublished, emai_EmailID desc), 
			   WebAddr = Emai_PRWebAddress 
	      from vCompanyEmail with (nolock) 
	     where emai_PRPublish = 'Y' 
		   and elink_Type = 'W') WebTable on wCompID = Comp_CompanyId and WebRank = 1
where
	Comp_PRListingStatus = 'L' 
	and Comp_PRType = 'H'
	and comp_PRIndustryType in ('P','T')
	and comp_PRTMFMAward is not null
	and comp_PRTMFMAwardDate is not null
	and (YEAR(GETDATE()) - year(comp_PRTMFMAwardDate)) % 5 = 0
	--and year(comp_PRTMFMAwardDate) != YEAR(GETDATE())
Order by (YEAR(GETDATE()) - year(comp_PRTMFMAwardDate)) desc, comp_PRBookTradeStyle
Set @BPCount = @@RowCount

Declare @ndx int; Set @ndx = 1
Declare @CompID int;
Declare @Class varchar(100)
Declare @Commod varchar(100)
DECLARE @comp_PRBookTradestyle varchar(420)
Declare @NamePart1 nvarchar(34)
Declare @NamePart2 nvarchar (34)
Declare @NamePart3 nvarchar (34)
DECLARE @LineBreakChar varchar(50); Set @LineBreakChar = Char(10)
Declare @LineSize int; SET @LineSize = 34
Declare @NameParts Table (idx smallint, NameLines Varchar(400))

While (@ndx &lt;= @BPCount) Begin
	Select @Class = ''
	Select @Commod = ''
	Select @Comp_PRBookTradeStyle = ''
	Select @NamePart1 = ''
	Select @NamePart2 = ''
	Select @NamePart3 = ''
	Select @CompID = CompanyID from @BPDirectory where ndx = @ndx
	Select @Comp_PRBookTradestyle = (Select TradeStyle from @BPDirectory where ndx = @ndx)

	--Get Classifications
		SELECT @Class = @Class + prcl_Abbreviation 
		from PRCompanyClassification 
		inner join PRClassification on prcl_ClassificationID = prc2_ClassificationID
		Where prc2_CompanyID = @CompID
		order by prc2_Percentage desc, prc2_CompanyClassificationID asc

	--Divide the Company name into quark size fields.  If logo is present limit to 22.  No logo = 34
	IF EXISTS (SELECT 1 from company where comp_PRLogo is not null and comp_CompanyId = @CompID) BEGIN
		IF (CHARINDEX('.', @comp_PRBookTradestyle, LEN(@comp_PRBookTradestyle)) = 0) BEGIN
			SET @comp_PRBookTradestyle = @comp_PRBookTradestyle + '.'
		END
		IF (LEN(@comp_PRBookTradestyle) &lt;= 22)
		BEGIN		
			SELECT @comp_PRBookTradestyle = 
					dbo.ufn_ApplyListingLineBreaks(@comp_PRBookTradestyle,@LineBreakChar)
		END 
		ELSE BEGIN
			DECLARE @PartA varchar(400), @PartB varchar(400), @PartALineBreak int
			-- first get the line 1 content at 22 characters
			SET @comp_PRBookTradestyle = dbo.ufn_ApplyListingLineBreaks2(@comp_PRBookTradestyle,@LineBreakChar, 22)
			-- Now find the first line break
			SET @PartALineBreak = CHARINDEX(@LineBreakChar, @comp_PRBookTradestyle)
			-- PartA is the first line; everything before the line break
			SET @PartA = SUBSTRING(@comp_PRBookTradestyle, 1, @PartALineBreak-1)
			-- PartB is everything that is left; this formats to a max of 20 characters/line
			SET @PartB = SUBSTRING(@comp_PRBookTradestyle, @PartALineBreak+LEN(@LineBreakChar), (LEN(@comp_PRBookTradestyle)-@PartALineBreak+LEN(@LineBreakChar))+1)
			-- remove the line break chars because they have to be set to 20 not 22
			SET @PartB = REPLACE(@PartB, @LineBreakChar, ' ')
			SELECT @comp_PRBookTradestyle = @PartA+@LineBreakChar+
					dbo.ufn_ApplyListingLineBreaksForLogo(@PartB, @LineBreakChar, 20, @LineSize, 3)
		END
	END ELSE BEGIN
		IF (CHARINDEX('.', @comp_PRBookTradestyle, LEN(@comp_PRBookTradestyle)) = 0) BEGIN
			SET @comp_PRBookTradestyle = @comp_PRBookTradestyle + '.'
		END
		SELECT @comp_PRBookTradestyle = dbo.ufn_ApplyListingLineBreaks(@comp_PRBookTradestyle, @LineBreakChar)

	End

	INSERT INTO @NameParts SELECT * FROM dbo.Tokenize(@Comp_PRBookTradeStyle, char(10))
	
	Set @NamePart1 = (Select Namelines from @NameParts where idx = 0)
	Set @NamePart2 = (Select Namelines from @NameParts where idx = 1)
	Set @NamePart3 = (Select Namelines from @NameParts where idx = 2)

	Update @BPDirectory
		Set Classifications = @Class,
			Commodities = @Commod,
			TradeStyle1 = @NamePart1,
			TradeStyle2 = @NamePart2,
			TradeStyle3 = @NamePart3,
			ModifiedIndex = @ndx * 10
			where ndx = @ndx

	Delete from @NameParts
	Set @ndx = @ndx + 1
end

SELECT DividerAge,
		 TradingAge,
		 Country,
     StateAbbr,
	   City,
	   TradeStyle,
	   State,
	   '' as CompanyID,
	   ISNULL(CAST(Logo as varchar) + '.eps', '') as Logo,
	   TradeStyle1,
	   ISNULL(TradeStyle2, '') as TradeStyle2,
	   ISNULL(TradeStyle3, '') as TradeStyle3,
	   CityState,
	   Phone,
	   ISNULL(Fax, '') as Fax,
     ISNULL(Email, '') as Email,
	   ISNULL(Web, '') as Web,
	   ISNULL(Phrase, '') as Phrase,
	   ISNULL(CAST(TMYear as varchar), '') as TMYear,
	   Classifications
  FROM @BPDirectory
ORDER BY Country, ModifiedIndex ASC</CommandText>
      </Query>
      <Fields>
        <Field Name="DividerAge">
          <DataField>DividerAge</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="TradingAge">
          <DataField>TradingAge</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Country">
          <DataField>Country</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="StateAbbr">
          <DataField>StateAbbr</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="City">
          <DataField>City</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TradeStyle">
          <DataField>TradeStyle</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="State">
          <DataField>State</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyID">
          <DataField>CompanyID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Logo">
          <DataField>Logo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TradeStyle1">
          <DataField>TradeStyle1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TradeStyle2">
          <DataField>TradeStyle2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TradeStyle3">
          <DataField>TradeStyle3</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CityState">
          <DataField>CityState</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Phone">
          <DataField>Phone</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Fax">
          <DataField>Fax</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Email">
          <DataField>Email</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Web">
          <DataField>Web</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Phrase">
          <DataField>Phrase</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TMYear">
          <DataField>TMYear</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Classifications">
          <DataField>Classifications</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>2b073106-59a6-40ff-acdc-3276560f254d</rd:ReportID>
</Report>