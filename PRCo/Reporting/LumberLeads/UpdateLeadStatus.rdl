<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="LumberLeads">
      <DataSourceReference>LumberLeads</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>064bd887-3230-400e-a22b-12963b9bb9b2</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="UpdateStatus">
      <Query>
        <DataSourceName>LumberLeads</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@NewStatus">
            <Value>=Parameters!NewStatus.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@SystemUser">
            <Value>=mid(User!UserID , InStr(User!UserID,"\")+1)</Value>
          </QueryParameter>
          <QueryParameter Name="@LeadID">
            <Value>=Parameters!LeadID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>UPDATE Lead
   SET Status = @NewStatus,
       StatusChangedBy = @SystemUser,
	   StatusChangedDate = GETDATE(),
	   ClosedDateTime = CASE @NewStatus WHEN 'Open' THEN NULL ELSE GETDATE() END
 WHERE LeadID = @LeadID
   AND Status &lt;&gt; @NewStatus

SELECT LeadID, Status
  FROM Lead
WHERE LeadID = @LeadID</CommandText>
      </Query>
      <Fields>
        <Field Name="LeadID">
          <DataField>LeadID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Status">
          <DataField>Status</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Textbox Name="textbox23">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>Lumber Listing Lead Status</Value>
                    <Style>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>14pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <Color>SteelBlue</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Center</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>textbox23</rd:DefaultName>
            <Height>0.25in</Height>
            <Width>6.5in</Width>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox40">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>Lead ID:</Value>
                    <Style>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.25in</Top>
            <Left>2.25in</Left>
            <Height>0.25in</Height>
            <Width>0.875in</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox41">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=First(Fields!LeadID.Value)</Value>
                    <Style />
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Left</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.25in</Top>
            <Left>3.125in</Left>
            <Height>0.25in</Height>
            <Width>1.19792in</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox42">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>New Status:</Value>
                    <Style>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.5in</Top>
            <Left>2.25in</Left>
            <Height>0.25in</Height>
            <Width>0.875in</Width>
            <ZIndex>3</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox43">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=First(Fields!Status.Value, "UpdateStatus")</Value>
                    <Style />
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Left</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.5in</Top>
            <Left>3.125in</Left>
            <Height>0.25in</Height>
            <Width>1.19792in</Width>
            <ZIndex>4</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="Textbox6">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>View Lead Details</Value>
                    <Style>
                      <FontWeight>Bold</FontWeight>
                      <TextDecoration>Underline</TextDecoration>
                      <Color>Blue</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Center</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox6</rd:DefaultName>
            <ActionInfo>
              <Actions>
                <Action>
                  <Drillthrough>
                    <ReportName>LeadDetail</ReportName>
                    <Parameters>
                      <Parameter Name="LeadID">
                        <Value>=First(Fields!LeadID.Value, "UpdateStatus")</Value>
                      </Parameter>
                    </Parameters>
                  </Drillthrough>
                </Action>
              </Actions>
            </ActionInfo>
            <Top>1.12167in</Top>
            <Height>0.25in</Height>
            <Width>6.5in</Width>
            <ZIndex>5</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox44">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>User:</Value>
                    <Style>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Right</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.75in</Top>
            <Left>2.25in</Left>
            <Height>0.25in</Height>
            <Width>0.875in</Width>
            <ZIndex>6</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="textbox45">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>=mid(User!UserID , InStr(User!UserID,"\")+1)</Value>
                    <Style />
                  </TextRun>
                </TextRuns>
                <Style>
                  <TextAlign>Left</TextAlign>
                </Style>
              </Paragraph>
            </Paragraphs>
            <Top>0.75in</Top>
            <Left>3.125in</Left>
            <Height>0.25in</Height>
            <Width>1.88542in</Width>
            <ZIndex>7</ZIndex>
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>1.4625in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <LeftMargin>1in</LeftMargin>
        <RightMargin>1in</RightMargin>
        <TopMargin>1in</TopMargin>
        <BottomMargin>1in</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="LeadID">
      <DataType>Integer</DataType>
      <Prompt>Lead ID</Prompt>
    </ReportParameter>
    <ReportParameter Name="NewStatus">
      <DataType>String</DataType>
      <Prompt>New Status</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>Open</Value>
            <Label>Open</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>Reopened</Value>
            <Label>Reopened</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>Closed</Value>
            <Label>Closed</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>Closed: Matched</Value>
            <Label>Closed: Matched</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>Closed: Non-Factor</Value>
            <Label>Closed: Non-Factor</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>2</NumberOfColumns>
      <NumberOfRows>2</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>LeadID</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>1</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>NewStatus</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>9dfb6c0c-aef1-4cb7-985e-a112ad7823d5</rd:ReportID>
</Report>