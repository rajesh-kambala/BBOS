function DisableRequired(){bEnableRequireCheck=!1}function DisableValidation(){DisableRequired();bEnableValidation=!1}function preStdValidation(){return!0}function postStdValidation(){return!0}function disableControls(n){for(var i=0,t=0;t<n.length;t++)e=n.elements[t],e.getAttribute("tsiDisable")&&e.disabled==!1&&(e.disabled=!0,aDisabled[i]=e,i++);for(t=0;t<document.anchors.length;t++)e=document.anchors[t],e.getAttribute("tsiDisable")&&e.disabled==!1&&(e.disabled=!0,aDisabled[i]=e,i++)}function resetControls(){for(var n=0;n<aDisabled.length;n++)aDisabled[n].disabled=!1}function formOnSubmit(n){if(bEnableValidation==!1)return!0;disableControls(n);var t=!1;return preStdValidation(n)&&validateForm(n)&&postStdValidation(n)&&(t=!0),resetControls(),t}function validateForm(n){for(var t,f,h,u="",i="",r="",e="",o="",s="",a="",c,s="mm/dd/yy",l=0;l<n.length;l++)if((t=n.elements[l],!t.disabled)&&t.name!="__VIEWSTATE")if(t.type=="text"&&(t.value==null||t.value==""||isBlank(t.value)||(a=Trim(t.value),t.value=a)),t.type=="select-one"||t.type=="select-multiple"){if(bEnableRequireCheck&&t.getAttribute("tsiRequired")&&t.length>0&&(szValue=t.options[t.selectedIndex].value,szValue==null||szValue==""||isBlank(szValue)||szValue=="None"||szValue=="0")){u+="\n          "+t.getAttribute("tsiDisplayName");continue}}else if(t.type=="text"||t.type=="textarea"||t.type=="password"||t.type=="hidden"||t.type=="file"){if(bEnableRequireCheck&&t.getAttribute("tsiRequired")&&(t.value==null||t.value==""||isBlank(t.value))){u||i||(f=t);u+="\n          "+t.getAttribute("tsiDisplayName");continue}t.value.length>0&&(t.getAttribute("tsiInteger")!=null||t.getAttribute("tsiNumeric")!=null||t.getAttribute("tsiMin")!=null||t.getAttribute("tsiMax")!=null)&&(c=t.getAttribute("tsiInteger")?IsValidInteger(t.value):IsValidNumber(t.value),c?(h=parseFloat(t.value),(isNaN(h)||t.getAttribute("tsiMin")!=null&&h<t.getAttribute("tsiMin")||t.getAttribute("tsiMax")!=null&&h>t.getAttribute("tsiMax"))&&(u||i||r||(f=t),i+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a number",t.getAttribute("tsiMin")!=null&&(i+=" that is greater than or equal to "+t.getAttribute("tsiMin")),t.getAttribute("tsiMax")!=null&&t.getAttribute("tsiMin")!=null?i+=" and less than or equal to "+t.getAttribute("tsiMax"):t.getAttribute("tsiMax")!=null&&(i+=" that is less than or equal to "+t.getAttribute("tsiMax")),i+=".\n")):(u||i||r||(f=t),i+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a number",i+=".\n"),t.getAttribute("tsiEquals")!=null&&h!=t.getAttribute("tsiEquals")&&(u||i||r||(f=t),i+=" - The field "+t.getAttribute("tsiDisplayName"),t.getAttribute("tsiEquals")!=null&&(i+=" must equal to "+t.getAttribute("tsiEquals")),i+=".\n"));t.value.length>0&&t.getAttribute("tsiCurrency")&&(c=IsValidCurrency(t.value),c||(u||i||r||(f=t),i+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid currency amount.\n"));t.value.length>0&&t.getAttribute("tsiDate")&&(t.getAttribute("tsi4DigitYear")?(b4DigitYear=!0,s="mm/dd/yyyy"):(b4DigitYear=!1,s="mm/dd/yy"),bContinue=!0,t.getAttribute("tsiDateUnknown")&&(szValue=t.value.toLowerCase(),(szValue=="unknown"||szValue=="n/a"||szValue=="na")&&(bContinue=!1)),bContinue&&(IsValidDate(t.value,b4DigitYear)||(u||i||r||(f=t),r+=t.getAttribute("tsiDisplayName")==null?" - The Date field must be a valid date in the format "+s+".\n":" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid date in the format "+s+".\n"),t.value=make4DigitYear(t.value)));t.value.length>0&&t.getAttribute("tsiDateTime")&&(t.getAttribute("tsi4DigitYear")?(b4DigitYear=!0,s="mm/dd/yyyy"):(b4DigitYear=!1,s="mm/dd/yy"),bContinue=!0,t.getAttribute("tsiDateUnknown")&&(szValue=t.value.toLowerCase(),(szValue=="unknown"||szValue=="n/a"||szValue=="na")&&(bContinue=!1)),bContinue&&(IsValidDateTime(t.value)||(u||i||r||(f=t),r+=t.getAttribute("tsiDisplayName")==null?" - The Date/Time field must be a valid date in the format "+s+".\n":" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid date/time in the format "+s+" hh:mm am.\n")));t.value.length>0&&t.getAttribute("tsiEmail")&&(isValidEMail(t.value)||(o+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid Internet e-mail address.\n"));t.value.length>0&&t.getAttribute("tsiPhone")&&(isValidPhone(t.value)||(o+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid phone number.\n"));t.value.length>0&&t.getAttribute("tsiZip")&&(isValidZip(t.value)||(o+=" - The field "+t.getAttribute("tsiDisplayName")+" must be a valid U.S. or Canadian postal code.\n"));t.value.length>0&&t.getAttribute("tsiMaxLength")&&t.value.length>t.getAttribute("tsiMaxLength")&&(o+=" - The value for the field "+t.getAttribute("tsiDisplayName")+" exceeds the maximum allowable length of "+t.getAttribute("tsiMaxLength")+" characters.\n")}return u||i||r||o?(e="",u&&(e+=" - The following required field(s) are empty:\n",bUnknownAcceptable&&(e+="   (Some fields accept 'N/A' or 'Unknown')\n"),e+=u+"\n",(i||r)&&(e+="\n")),i&&(e+=i,(r||o)&&(e+="\n")),r&&(e+=r,o&&(e+="\n")),o&&(e+=o),displayErrorMessage(e),f!=null&&f.type!="hidden"&&(f.focus(),f.select()),!1):!0}function isBlank(n){for(var t,i=0;i<n.length;i++)if(t=n.charAt(i),t!=" "&&t!="\n"&&t!="\t")return!1;return!0}function IsValidDate(n,t){if(n=="mm/dd/yyyy")return!0;var i,u,f,r,e;return(i=new String(n),iSlash1=i.indexOf("/"),iSlash1==-1)?!1:iSlash1==i.length?!1:(iSlash2=i.indexOf("/",iSlash1+1),iSlash2==-1)?!1:(f=i.substring(0,iSlash1),u=i.substring(iSlash1+1,iSlash2),r=i.substring(iSlash2+1),iDay=parseFloat(u),isNaN(u)||isNaN(iDay))?!1:(iMonth=parseFloat(f),isNaN(f)||isNaN(iMonth))?!1:iMonth<1||iMonth>12?!1:(iYear=parseFloat(r),isNaN(r)||isNaN(iYear))?!1:t&&r.length<4?!1:(today=new Date,minYear=today.getFullYear()-150,maxYear=today.getFullYear()+20,inputDate=new Date(n),inputDate.getFullYear()<minYear||inputDate.getFullYear()>maxYear)?!1:r.length==3?!1:iYear<0?!1:(e=Math.round(iYear/4)==iYear/4?[31,29,31,30,31,30,31,31,30,31,30,31]:[31,28,31,30,31,30,31,31,30,31,30,31],iDay<1||iDay>e[iMonth-1])?!1:!0}function IsValidDateTime(n){var u,h,i,o,s,r,t,f,e;return(u=new String(n),t=u.indexOf(" "),t==-1)?!1:(h=u.substring(0,t),!IsValidDate(h,!1))?!1:(i=u.substring(t+1,u.length),iColon1=i.indexOf(":"),iColon1==-1)?!1:iColon1==i.length?!1:(t=i.indexOf(" ",iColon1+1),t==-1)?!1:(o=i.substring(0,iColon1),s=i.substring(iColon1+1,t),r=i.substring(t+1),f=parseFloat(o),isNaN(o)||isNaN(f))?!1:f<1||f>12?!1:(e=parseFloat(s),isNaN(s)||isNaN(e))?!1:e<0||e>59?!1:(r=r.toLowerCase(),r!="am"&&r!="a"&&r!="pm"&&r!="p")?!1:!0}function IsValidNumber(n){for(var i=!0,r=0,t=0;t<=n.length-1&&i;t++)"0123456789,.-".indexOf(n.charAt(t))==-1?i=!1:n.charAt(t)=="."?(r=r+1,r>1&&(i=!1)):n.charAt(t)=="-"&&t>0&&(i=!1);return i}function IsValidCurrency(n){for(var i=!0,e=!1,r=0,u=0,f=0,o=0,t=0;t<=n.length-1&&i;t++)n.charAt(t)=="$"?(f=f+1,o=t):n.charAt(t)=="-"&&t>0&&(t!=1||n.charAt(0)!="$")&&(i=!1),e==!0&&(u=u+1),n.charAt(t)=="."&&(r=r+1,e=!0),"0123456789,.".indexOf(n.charAt(t))==-1&&(i=!1);return r>1&&(i=!1),f>1&&(i=!1),o>0&&(i=!1),u>2&&(i=!1),i}function IsValidInteger(n){return IsValidNumber(n)&&n.indexOf(".")==-1&&n.indexOf(",")==-1?!0:!1}function Trim(n){for(var i=" ",t="",t=n;t.charAt(0)==i;)t=t.substring(1,t.length);while(t.charAt(t.length-1)==i)t=t.substring(0,t.length-1);return t}function displayErrorMessage(n){szHeader="_____________________________________________________\n\n";szHeader+="Please correct the following error(s):\n";szHeader+="_____________________________________________________\n\n";alert(szHeader+n)}function make4DigitYear(n){var r,u,t,i=new String(n);return iSlash1=i.indexOf("/"),iSlash2=i.indexOf("/",iSlash1+1),u=i.substring(0,iSlash1),r=i.substring(iSlash1+1,iSlash2),t=i.substring(iSlash2+1),t.length==2&&(iYear=parseFloat(t),iYear=iYear>90?iYear+1900:iYear+2e3,t=iYear),u+"/"+r+"/"+t}function IsValidDateRange(n,t){if(fromValue=Trim(n.value),toValue=Trim(t.value),fromValue.length>0&&toValue.length>0){var i=new Date(make4DigitYear(fromValue)),r=new Date(make4DigitYear(toValue));if(i>r)return"An invalid date range has been specified for the "+n.getAttribute("tsiDisplayName")+" and "+t.getAttribute("tsiDisplayName")+" fields.\n"}return""}function IsValidDateRange2(n,t){if(fromValue=Trim(n.value),toValue=Trim(t.value),fromValue.length>0&&toValue.length==0)return"When a value is specified for the "+n.getAttribute("tsiDisplayName")+" field, a value is required for the "+t.getAttribute("tsiDisplayName")+" field.";if(toValue.length>0&&fromValue.length==0)return"When a value is specified for the "+t.getAttribute("tsiDisplayName")+" field, a value is required for the "+n.getAttribute("tsiDisplayName")+" field.";if(fromValue.length>0&&toValue.length>0){var i=new Date(make4DigitYear(fromValue)),r=new Date(make4DigitYear(toValue));if(i>r)return"An invalid date range has been specified for the "+n.getAttribute("tsiDisplayName")+" and "+t.getAttribute("tsiDisplayName")+" fields.\n"}return""}function IsValidDateRangeMsg2(n,t){if(fromValue=Trim(n.value),toValue=Trim(t.value),fromValue.length>0&&toValue.length>0){var i=new Date(make4DigitYear(fromValue)),r=new Date(make4DigitYear(toValue));if(i>r)return"- The field "+n.getAttribute("tsiDisplayName")+" must be earlier than the field "+t.getAttribute("tsiDisplayName")+".\n"}return""}function IsValidNumericRange(n,t){var i=0,r=0;return(i=parseFloat(n.value),r=parseFloat(t.value),i>r)?"An invalid range has been specified for the "+n.getAttribute("tsiDisplayName")+" and "+t.getAttribute("tsiDisplayName")+" fields.\n":""}function getDaysInMonth(n){var t=new Array(12),r,i;return t[0]=31,t[1]=28,t[2]=31,t[3]=30,t[4]=31,t[5]=30,t[6]=31,t[7]=31,t[8]=30,t[9]=31,t[10]=30,t[11]=31,r=new Date(n.value),i=r.getMonth(),daysInMonth=i==1&&isLeapYear(n)?29:t[i]}function isLeapYear(n){if(date=new Date(n.value),year=date.getYear(),year%100==0){if(year%400==0)return!0}else if(year%4==0)return!0;return!1}function isFutureDate(n){var i=new Date,t;return(iSlash1=n.indexOf("/"),iSlash1==-1)?!1:iSlash1==n.length?!1:(iSlash2=n.indexOf("/",iSlash1+1),iSlash2==-1)?!1:(szMonth=n.substring(0,iSlash1),szDay=n.substring(iSlash1+1,iSlash2),szYear=n.substring(iSlash2+1),t=new Date(szYear,szMonth-1,szDay),t>i?!0:!1)}function isPastDate(n){var t=new Date,i=new Date(n.substring(6,10),n.substring(0,2)-1,n.substring(3,5));return i<t?!0:!1}function isValidEMail(n){for(iAtSignCount=0,iPosofAtSign=0,iPosofRightMostDot=0,bSpaceFound=!1,n=Trim(n),iIndex=0;iIndex<=n.length-1;iIndex++)n.charAt(iIndex)=="@"&&(iAtSignCount=iAtSignCount+1,iPosofAtSign=iIndex),n.charAt(iIndex)=="."&&(iPosofRightMostDot=iIndex),n.charAt(iIndex)==" "&&(bSpaceFound=!0);return iAtSignCount!=1||iPosofAtSign>iPosofRightMostDot||bSpaceFound?!1:!0}function isValidPhone(n){if(n.length==0)return!0;if(n.length==8){if(szDelimiter=n.charAt(3),szDelimiter!="-"&&szDelimiter!=".")return!1;szExchange=n.substring(0,3);szNumber=n.substring(4,8)}else if(n.length==7)szExchange=n.substring(0,3),szNumber=n.substring(3,7);else return!1;return IsValidInteger(szExchange)==!1?!1:IsValidInteger(szNumber)==!1?!1:szExchange=="555"?!1:!0}function isValidZip(n){if(n.length==5){if(!IsValidInteger(n))return!1}else if(n.length==10){if(n.charAt(5)!="-"||!IsValidInteger(n.substring(0,4))||!IsValidInteger(n.substring(6,10)))return!1}else if(n.length==7){if(n.charAt(3)!=" "||!IsValidAlphabetic(n.substring(0,1))||!IsValidInteger(n.substring(1,2))||!IsValidAlphabetic(n.substring(2,3))||!IsValidInteger(n.substring(4,5))||!IsValidAlphabetic(n.substring(5,6))||!IsValidInteger(n.substring(6,7)))return!1}else return!1;return!0}function IsValidAlphabetic(n){var t,i=!0;for(szLowerText=n.toLowerCase(),t=0;t<=szLowerText.length-1&&i;t++)"abcdefghijklmnopqrstuvwxyz".indexOf(szLowerText.charAt(t))==-1&&(i=!1);return i}function ValidateTextAreaLength(n,t){var i=n.value;t&&i.length>t-1&&(event.returnValue=!1,t=parseInt(t))}var bUnknownAcceptable=!1,bEnableRequireCheck=!0,bEnableValidation=!0,aDisabled=[];